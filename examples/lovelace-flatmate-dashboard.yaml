# Resources `/hass_flatmate/static/hass-flatmate-shopping-card.js` and
# `/hass_flatmate/static/hass-flatmate-cleaning-card.js` are auto-added in
# Lovelace storage mode. Add them manually only if you use YAML resources mode.
title: Flatmate
views:
  - title: Flatmate
    path: flatmate
    type: sections
    max_columns: 3
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Shopping
            icon: mdi:cart-outline

          - type: custom:hass-flatmate-shopping-card
            entity: sensor.hass_flatmate_shopping_data
            title: Shared Shopping

          - type: tile
            entity: sensor.hass_flatmate_shopping_open_count
            name: Shopping Open Items

          - type: picture-entity
            entity: image.hass_flatmate_shopping_distribution_90d
            name: Shopping Distribution (90 days)
            show_state: false
            show_name: true

      - type: grid
        cards:
          - type: heading
            heading: Cleaning
            icon: mdi:broom

          - type: custom:hass-flatmate-cleaning-card
            entity: sensor.hass_flatmate_cleaning_schedule
            title: Weekly Cleaning
            weeks: 5

          - type: entities
            title: Notification Test Mode
            entities:
              - entity: switch.hass_flatmate_notification_test_mode
              - entity: select.hass_flatmate_notification_test_target
              - entity: select.hass_flatmate_shopping_calendar_target
              - entity: select.hass_flatmate_cleaning_calendar_target

      - type: grid
        cards:
          - type: heading
            heading: Activity
            icon: mdi:calendar-clock

          - type: entity
            entity: calendar.hass_flatmate_activity
            name: Flatmate Activity Calendar

          - type: markdown
            title: Recent Activity
            content: >
              {% set events = state_attr('sensor.hass_flatmate_activity_recent', 'recent_human') or [] %}
              {% if events | length == 0 %}
              No recent events.
              {% else %}
              {% for event in events[:10] %}
              - {{ relative_time(as_datetime(event.created_at)) }} | {{ event.summary }}
              {% endfor %}
              {% endif %}
